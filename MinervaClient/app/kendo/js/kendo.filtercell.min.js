/*
* Kendo UI Beta v2014.2.625 (http://www.telerik.com/kendo-ui)
* Copyright 2014 Telerik AD. All rights reserved.
*
* Kendo UI Beta license terms available at
* http://www.telerik.com/purchase/license-agreement/kendo-ui-beta.aspx
*/

!function(e,define){define(["./kendo.autocomplete.min","./kendo.datepicker.min","./kendo.numerictextbox.min","./kendo.dropdownlist.min"],e)}(function(){return function(e,t){function n(t,i){var o,r,a=[];if(e.isPlainObject(t))if(t.hasOwnProperty("filters"))a=t.filters;else if(t.field==i)return t;for(e.isArray(t)&&(a=t),o=0;a.length>o;o++)if(r=n(a[o],i))return r}function i(t,n){t.filters&&(t.filters=e.grep(t.filters,function(e){return i(e,n),e.filters?e.filters.length:e.field!=n}))}function o(e,t){return function(n){for(var i,o,r=e(n),a=[],s=0,l={};r.length>s;)i=r[s++],o=i[t],l.hasOwnProperty(o)||(a.push(i),l[o]=!0);return a}}var r=window.kendo,a=r.ui,s=r.data.DataSource,l=a.Widget,d="change",c="string",u="Is equal to",p="Is not equal to",f=e.proxy,h=l.extend({init:function(t,n){var i,o,a,u,p,h=this,m=h.input=e("<input/>").attr(r.attr("bind"),"value: value").appendTo(t);l.fn.init.call(h,t,n),n=h.options,i=h.dataSource=n.dataSource,h.model=i.options.schema.model,u=n.type=r.getter("options.schema.model.fields['"+n.field+"'].type",!0)(i)||c,t=e(t),t.addClass("grid-filter-header"),h._parse=function(e){return e+""},h.model&&h.model.fields&&(p=h.model.fields[n.field],p&&p.parse&&(h._parse=f(p.parse,p))),h.viewModel=a=r.observable({operator:n.operator,value:null}),a.bind(d,f(h.updateDsFilter,h)),h._setInputType(n,u),h._createClearIcon(),r.bind(m,a),u==c&&(o=h.suggestDataSource=n.suggestDataSource,o instanceof s||(o=h.suggestDataSource=s.create(e.extend(o,{group:[]}))),h.setSuggestDataSource(o)),h.refreshUI(),h._refreshHandler=f(h.refreshUI,h),h.dataSource.bind(d,h._refreshHandler)},_setInputType:function(e,t){var n=this,i=n.input;"function"==typeof e.template?e.template.call(n.viewModel,n.input):t==c?i.attr(r.attr("role"),"autocomplete").attr(r.attr("text-field"),n.options.field).attr(r.attr("value-primitive"),!0):"date"==t?i.attr(r.attr("role"),"datepicker"):"number"==t&&i.attr(r.attr("role"),"numerictextbox")},setSuggestDataSource:function(e){this.options.customDataSource||(e._pageSize=t,e.reader.data=o(e.reader.data,this.options.field)),this.suggestDataSource=e;var n=this.input.data("kendoAutoComplete");n&&n.setDataSource(e)},refreshUI:function(){var e=this;e._bind()},_bind:function(){var e=this,t=n(e.dataSource.filter(),this.options.field)||{},i=e.viewModel;e.manuallyUpdatingVM=!0,t.operator&&i.set("operator",t.operator),i.set("value",t.value),e.manuallyUpdatingVM=!1},updateDsFilter:function(){var t,n,i,o=this;o.manuallyUpdatingVM||(t=e.extend({},o.viewModel.toJSON(),{field:o.options.field}),n={logic:"and",filters:[t]},i=o._merge(n),o.dataSource.filter(i.filters.length?i:{}))},_merge:function(t){var n,o,r,a=this,s=t.logic||"and",l=t.filters,d=a.dataSource.filter()||{filters:[],logic:"and"};for(i(d,a.options.field),l=e.grep(l,function(e){return""!==e.value&&null!==e.value}),o=0,r=l.length;r>o;o++)n=l[o],n.value=a._parse(n.value);return l.length&&(d.filters.length?(t.filters=l,"and"!==d.logic&&(d.filters=[{logic:d.logic,filters:d.filters}],d.logic="and"),d.filters.push(l.length>1?t:l[0])):(d.filters=l,d.logic=s)),d},_createClearIcon:function(){var t=this;e("<button class='k-button k-button-icon'/>").html("<span class='k-icon k-i-close'/>").click(f(t.clearFilter,t)).appendTo(t.element)},clearFilter:function(){this.viewModel.set("value",null)},destroy:function(){var e=this;e.filterModel=null,l.fn.destroy.call(e),r.destroy(e.element)},events:[d],options:{name:"FilterCell",autoBind:!0,customDataSource:!1,field:"",type:"string",suggestDataSource:null,operator:"eq",template:null,operators:{string:{eq:u,neq:p,startswith:"Starts with",contains:"Contains",doesnotcontain:"Does not contain",endswith:"Ends with"},number:{eq:u,neq:p,gte:"Is greater than or equal to",gt:"Is greater than",lte:"Is less than or equal to",lt:"Is less than"},date:{eq:u,neq:p,gte:"Is after or equal to",gt:"Is after",lte:"Is before or equal to",lt:"Is before"},enums:{eq:u,neq:p}},messages:{isTrue:"is true",isFalse:"is false",filter:"Filter",clear:"Clear",and:"And",or:"Or",operator:"Operator",value:"Value",cancel:"Cancel"}}});a.plugin(h)}(window.kendo.jQuery),window.kendo},"function"==typeof define&&define.amd?define:function(e,t){t()});